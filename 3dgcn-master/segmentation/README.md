# Segmentation on ShapeNetPart
#### All our code for classification is in `segmentation/3dgcnsegmentation.ipynb`.
<img src="../imgs/model_seg.png" alt="segmentation model" width="500" />

Model structure for segmentation

<img src="../imgs/model_op.png" alt="segmentation model" width="500" />

Model structure after modificaiton

## Dataset
ShapeNet is used in segmentation task, more detail information about this datasset can be found on this [official website](https://www.shapenet.org/). To download the dataset, please run: 
```
bash download.sh
```
the resulting dataset is `shapenetcore_partanno_segmentation_benchmark_v0/`. 

## Hyper-parameters
Descriptions of all hyper parameters are shown by running:
```
python3 main.py -h
```
Default values are speciifed in `main.py`.

## Training 
To train GCN3D, please **add/remove/edit** hyper parameters in `train.sh` (e.g. dataset for `-dataset` argument), and run: 
```
bash train.sh
```
To train optimized network, change **from model_gcn3d import GCN3D** in `main.py` into **from model_gcn3d_optimized import GCN3D** before training.

## Testing
After training, please **add/remove/edit** hyper parameters in `test.sh`, and run the evaluation:
```
bash test.sh
```
which would show the mIoU (average over *all categories / all instances / each category* ) on testing set.

## Machine Learning Algorithm:
**k-means**
```
python kmean.py
```
**svm**
```
python svm.py
```

## Notifications
1.When testing, object transformation can be added by editing `-shift`, `-scale`, `-rotate`, `-random`. Compared with pervious works, 3D-GCN is **shift- and scale-invariant** and less sensitive to rotation, which is much more robust.

2.Two model are pretrained. `Model.pkl` are pretrained model for origin network, and `Model2.pkl` are pretrained model for network after optimization.

## Visualization
When trianing and testing, visualization images for segmentation results can be generated by adding argument `-output`. 

## Reproductive Result
Comparision with PointNet and Machine Learning Network.
![](../imgs/segmentation Result.png)

Invariance Testing
![](../imgs/IT.png)


